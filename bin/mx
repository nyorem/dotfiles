#!/usr/bin/env bash

# Adapted from : https://github.com/pengwynn/dotfiles/blob/e730eef6ce384cdb0b4526783bf0e6b0c68cbabc/bin/mx

# Launch a tmux session

set -e

# The name of the session if either the name of the current directory
# or passed as an argument
if [ -z "$1" ]; then
    SESSION="${PWD##*/}"
else
    SESSION="$1"
fi

# If the session does not exist, create it
if ! (tmux list-sessions | cut -d':' -f1 | grep -q ^"$SESSION"\$); then
    tmux new-session -s "$SESSION" -d

    # One window is an editing window
    tmux send-keys "$EDITOR" C-m :vs . C-m

    # One for a shell
    tmux new-window -t "$SESSION"

    # Select the first
    tmux select-window -t "$SESSION":0
fi

# Attach it
tmux attach -t "$SESSION"

